<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Matrix Generator</title>

<style>
:root{
  --card:#02091a;
  --accent:#22c55e;
  --muted:#9ff2c7;
}
*{box-sizing:border-box;font-family:Inter,system-ui}

body{
  margin:0;
  background:#000;
  color:#eafff8;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

/* MATRIX */
canvas{
  position:fixed;
  inset:0;
  z-index:-1;
}

/* === CARD 9:16 === */
.wrap{
  width:360px;
  aspect-ratio:9/16;
  background:rgba(2,9,26,.94);
  backdrop-filter:blur(10px);
  border-radius:16px;
  padding:14px;
  box-shadow:
    0 0 30px rgba(34,197,94,.45),
    inset 0 0 0 1px rgba(255,255,255,.05);
  display:flex;
  flex-direction:column;
}

/* HEADER */
header{
  display:flex;
  gap:10px;
  align-items:center;
  margin-bottom:12px;
}

.avatar{
  width:38px;
  height:38px;
  border-radius:50%;
  background:url("https://files.catbox.moe/lg5s5a.jpg") center/cover;
  border:2px solid var(--accent);
}

/* FORM */
label{
  font-size:11px;
  color:var(--muted);
}

textarea,select{
  width:100%;
  margin-top:6px;
  padding:7px;
  border-radius:7px;
  border:none;
  background:var(--card);
  color:#eafff8;
  font-size:11px;
}

/* BUTTON */
.buttons{
  display:flex;
  gap:6px;
  margin-top:10px;
}

button{
  flex:1;
  padding:6px 0;
  border:none;
  border-radius:7px;
  background:linear-gradient(135deg,#22c55e,#16a34a);
  font-weight:700;
  font-size:11px;
  cursor:pointer;
}
button.ghost{
  background:transparent;
  border:1px solid rgba(34,197,94,.4);
  color:var(--muted);
}

/* PREVIEW */
.preview{
  margin-top:14px;
  flex:1;
  background:rgba(0,0,0,.6);
  border-radius:12px;
  border:1px solid rgba(34,197,94,.35);
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

.preview img{
  max-width:75%;
  max-height:75%;
  object-fit:contain;
}

/* LOADING */
.spinner{
  width:26px;height:26px;
  border:3px solid rgba(255,255,255,.25);
  border-top-color:var(--accent);
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

footer{
  text-align:center;
  font-size:9px;
  color:var(--muted);
  opacity:.6;
  margin-top:8px;
}
</style>
</head>

<body>

<audio id="bgm" autoplay muted loop>
  <source src="https://files.catbox.moe/ptwzfc.mp4" type="audio/mp4">
</audio>

<canvas id="matrix"></canvas>

<div class="wrap">

<header>
  <div class="avatar"></div>
  <div>
    <strong style="font-size:12px">Kyy Ah Ah</strong><br>
    <small style="font-size:10px;color:#9ff2c7">Sticker Generator</small>
  </div>
</header>

<label>Text / Prompt</label>
<textarea id="text" rows="2" placeholder="masukkan teks..."></textarea>

<label style="margin-top:10px">Mode</label>
<select id="mode">
  <option value="aqul">Sticker Brat</option>
  <option value="iqc">IQC</option>
  <option value="ustad">Pak Ustad v2</option>
</select>

<div class="buttons">
  <button id="generate">Generate</button>
  <button class="ghost" id="clear">Clear</button>
  <button id="download">Download</button>
</div>

<div class="preview">
  <div id="loading" style="display:none">
    <div class="spinner"></div>
  </div>
  <img id="img">
</div>

<footer>© Powered By Kyy</footer>
</div>

<script>
/* AUDIO */
document.body.addEventListener("click",()=>bgm.muted=false,{once:true})

/* MATRIX */
const c = matrix,
      x = c.getContext("2d")

function resize(){
  c.width = innerWidth
  c.height = innerHeight
}
resize()
addEventListener("resize",resize)

const chars="01アイウエオ"
const size=14
let drops=Array(Math.floor(c.width/size)).fill(1)

setInterval(()=>{
  x.fillStyle="rgba(0,0,0,.12)"
  x.fillRect(0,0,c.width,c.height)
  x.fillStyle="#22c55e"
  x.font=size+"px monospace"
  drops.forEach((y,i)=>{
    x.fillText(chars[Math.random()*chars.length|0],i*size,y*size)
    if(y*size>c.height && Math.random()>.99) drops[i]=0
    drops[i]++
  })
},60)

/* GENERATOR */
let blob=null
generate.onclick=async()=>{
  if(!text.value.trim()) return
  loading.style.display="block"

  let url =
    mode.value==="iqc"
    ? `https://api-faa.my.id/faa/iqc?prompt=${encodeURIComponent(text.value)}`
    : mode.value==="ustad"
    ? `https://api.taka.my.id/pak-ustadv2?text=${encodeURIComponent(text.value)}`
    : `https://aqul-brat.hf.space/?text=${encodeURIComponent(text.value)}`

  const r = await fetch(url)
  blob = await r.blob()
  img.src = URL.createObjectURL(blob)
  loading.style.display="none"
}

download.onclick=()=>{
  if(!blob) return
  const a=document.createElement("a")
  a.href=URL.createObjectURL(blob)
  a.download="sticker.png"
  a.click()
}

clear.onclick=()=>{
  text.value=""
  img.src=""
  blob=null
}
</script>

</body>
</html>